source("globals.R")
setwd("C:/Users/chuu/varbdr/code")
source("globals.R")
source(BETA_1)                                   # data generating scheme # 1
# (0) simulate first set of synthetic data (beta1)
N           = 100                                # number of observations
K           = 5                                  # number of clusters
synth_data1 = old_beta1(N, seed = 123)
y1          = synth_data1$y                      # (N x 1)
X1          = synth_data1$X                      # (N x 2)
param_mat1  = synth_data1$shape                  # (N x 2)
# (1) covariate-INDEPENENT vb
source(paste(COV_INDEP, VARBDR, sep = '/'))      # load cov-indep varbdr.R
theta1_1 = varbdr(y = y1, X = X1, K = K)           # store CAVI results
# (1) covariate-INDEPENENT vb
source(paste(COV_INDEP, VARBDR, sep = '/'))      # load cov-indep varbdr.R
theta1_1 = varbdr(y = y1, X = X1, K = K)           # store CAVI results
# (2) covariate-DEPENDENT vb
source(paste(COV_DEP, VARBDR, sep = '/'))        # load cov-dep varbdr.R
theta1_2 = varbdr(y = y1, X = X1, K = K)           # store CAVI results
source(DENSITY)
n = 30
y_grid = seq(0, 1, len = 500)
params1 = list(shape1 = param_mat1[n,1], shape2 = param_mat1[n,2])
p1 = plotDensities(y_grid, X1[n,], dbeta, params1, py_0, theta1_1, K)
p1$overlay
p2 = plotDensities(y_grid, X1[n,], dbeta, params1, py_bouch, theta1_2, K)
p2$overlay
# same for each beta algorithm
y_grid  = seq(0, 1, len = 500)
approx_d  = list(py_0, py_bouch)          # list of approx density functions
den_label = c("cov-indep", "cov-dep (b)") # labels for each approx density
n = 30
x       = X1[n,]
params1 = list(shape1 = param_mat1[n,1], shape2 = param_mat1[n,2])
theta1  = list(theta1_1, theta1_2)          # list of var. params for each alg
compareDensities(y_grid, x,
dbeta, params,
approx_d, den_label,
theta, K)
n = 30
x       = X1[n,]
params1 = list(shape1 = param_mat1[n,1], shape2 = param_mat1[n,2])
theta1  = list(theta1_1, theta1_2)          # list of var. params for each alg
compareDensities(y_grid, x,
dbeta, params,
approx_d, den_label,
theta1, K)
n = 30
x       = X1[n,]
params1 = list(shape1 = param_mat1[n,1], shape2 = param_mat1[n,2])
theta1  = list(theta1_1, theta1_2)          # list of var. params for each alg
compareDensities(y_grid, x,
dbeta, params1,
approx_d, den_label,
theta1, K)
plotELBO(theta1_1)
plotELBO(theta1_2)
## beta2 simulations -----------------------------------------------------------
source(BETA_2)
N           = 100                                # number of observations
K           = 5                                  # number of clusters
synth_data2 = beta2(N)
y2          = synth_data2$y                      # (N x 1)
X2          = synth_data2$X                      # (N x 2)
param_mat2  = synth_data2$shape                  # (N x 2)
# (1) covariate-INDEPENENT vb
source(paste(COV_INDEP, VARBDR, sep = '/'))      # load cov-indep varbdr.R
theta2_1 = varbdr(y = y2, X = X2, K = K)         # store CAVI results
# (2) covariate-DEPENDENT vb
source(paste(COV_DEP, VARBDR, sep = '/'))        # load cov-dep varbdr.R
theta2_2 = varbdr(y = y2, X = X2, K = K)         # store CAVI results
n = 99
x       = X2[n,]
params2 = list(shape1 = param_mat2[n,1], shape2 = param_mat2[n,2])
theta2  = list(theta2_1, theta2_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params2,
approx_d, den_label,
theta2, K)
plotELBO(theta2_2)
plotELBO(theta2_1)
plotELBO(theta2_2)
## beta2 simulations -----------------------------------------------------------
source(BETA_2)
N           = 500                                # number of observations
K           = 10                                 # number of clusters
synth_data2 = beta2(N)
y2          = synth_data2$y                      # (N x 1)
X2          = synth_data2$X                      # (N x 2)
param_mat2  = synth_data2$shape                  # (N x 2)
# (1) covariate-INDEPENENT vb
source(paste(COV_INDEP, VARBDR, sep = '/'))      # load cov-indep varbdr.R
theta2_1 = varbdr(y = y2, X = X2, K = K)         # store CAVI results
# (2) covariate-DEPENDENT vb
source(paste(COV_DEP, VARBDR, sep = '/'))        # load cov-dep varbdr.R
theta2_2 = varbdr(y = y2, X = X2, K = K)         # store CAVI results
n = 99
x       = X2[n,]
params2 = list(shape1 = param_mat2[n,1], shape2 = param_mat2[n,2])
theta2  = list(theta2_1, theta2_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params2,
approx_d, den_label,
theta2, K)
n = 100
x       = X2[n,]
params2 = list(shape1 = param_mat2[n,1], shape2 = param_mat2[n,2])
theta2  = list(theta2_1, theta2_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params2,
approx_d, den_label,
theta2, K)
plotELBO(theta2_1)
plotELBO(theta2_2)
# save R objects for N = 500, K = 4
save(theta2_2, file = "theta_dep_beta2_500.rds")
testRead = readRDS(file = "theta_dep_beta2_500.rds")
# save R objects for N = 500, K = 4
save(theta2_2, file = "theta_dep_beta2_500.RDS")
testRead = readRDS(file = "theta_dep_beta2_500.rds")
saveRDS(theta2_2, file = "theta_dep_beta2_500.RDS")
testRead = readRDS(file = "theta_dep_beta2_500.rds")
plotELBO(testRead)
compareDensities(y_grid, x,
dbeta, params2,
approx_d, den_label,
theta2, K)
plotELBO(testRead)
saveRDS(theta2_1, file = "theta_indep_beta2_500.RDS")
source("globals.R")
theta_sparse =
source(BETA_2_MODIFIED)
N           = 200                                # number of observations
K           = 4                                  # number of clusters
synth_data3 = beta2_modified(N)
dim(X)
dim(X3)
y3          = synth_data3$y                      # (N x 1)
X3          = synth_data3$X                      # (N x 2)
param_mat3  = synth_data3$shape                  # (N x 2)
dim(X3)
# (1) covariate-INDEPENENT vb
source(paste(COV_INDEP, VARBDR, sep = '/'))      # load cov-indep varbdr.R
theta3_1 = varbdr(y = y3, X = X3, K = K)         # store CAVI results
# (2) covariate-DEPENDENT vb
source(paste(COV_DEP, VARBDR, sep = '/'))        # load cov-dep varbdr.R
theta3_2 = varbdr(y = y3, X = X3, K = K)         # store CAVI results
theta3_2$mu_k
theta3_2$gamma_k
n = 100
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
n = 143
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
n = 141
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
source(BETA_2_MODIFIED)
N           = 200                                # number of observations
K           = 4                                  # number of clusters
synth_data3 = beta2_modified(N)
y3          = synth_data3$y                      # (N x 1)
X3          = synth_data3$X                      # (N x 2)
param_mat3  = synth_data3$shape                  # (N x 2)
# (1) covariate-INDEPENENT vb
source(paste(COV_INDEP, VARBDR, sep = '/'))      # load cov-indep varbdr.R
theta3_1 = varbdr(y = y3, X = X3, K = K)         # store CAVI results
# (2) covariate-DEPENDENT vb
source(paste(COV_DEP, VARBDR, sep = '/'))        # load cov-dep varbdr.R
theta3_2 = varbdr(y = y3, X = X3, K = K)         # store CAVI results
n = 141
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
plotELBO(theta3_1)
plotELBO(theta3_2)
source(BETA_2_MODIFIED)
N           = 1000                               # number of observations
K           = 4                                  # number of clusters
synth_data3 = beta2_modified(N)
y3          = synth_data3$y                      # (N x 1)
X3          = synth_data3$X                      # (N x 2)
param_mat3  = synth_data3$shape                  # (N x 2)
# (1) covariate-INDEPENENT vb
source(paste(COV_INDEP, VARBDR, sep = '/'))      # load cov-indep varbdr.R
theta3_1 = varbdr(y = y3, X = X3, K = K)         # store CAVI results
# (2) covariate-DEPENDENT vb
source(paste(COV_DEP, VARBDR, sep = '/'))        # load cov-dep varbdr.R
theta3_2 = varbdr(y = y3, X = X3, K = K)         # store CAVI results
n = 141
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
n = 189
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
n = 289
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
n = 389
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
n = 421
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
plotELBO(theta3_1)
plotELBO(theta3_2)
plotELBO(theta3_1)
n = 321
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
n = 142
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
n = 143
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
n = 147
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
n = 100
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
n = 30
x       = X3[n,]
params3 = list(shape1 = param_mat3[n,1], shape2 = param_mat3[n,2])
theta3  = list(theta3_1, theta3_2)               # list of var. params
compareDensities(y_grid, x,
dbeta, params3,
approx_d, den_label,
theta3, K)
plotELBO(theta3_1)
plotELBO(theta3_2)
